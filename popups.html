<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PDF Popup Opener</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 50px auto;
        padding: 20px;
        background-color: #f5f5f5;
      }

      .container {
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      h1 {
        color: #333;
        text-align: center;
        margin-bottom: 30px;
      }

      .button-group {
        display: flex;
        gap: 15px;
        justify-content: center;
        flex-wrap: wrap;
      }

      button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 500;
        transition: all 0.3s ease;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      }

      button:active {
        transform: translateY(0);
      }

      .status {
        margin-top: 20px;
        padding: 10px;
        border-radius: 5px;
        text-align: center;
        font-weight: 500;
      }

      .status.success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }

      .status.error {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }

      .instructions {
        background: #e7f3ff;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 20px;
        border-left: 4px solid #2196f3;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>PDF Popup Window Opener</h1>

      <div class="instructions">
        <strong>Instructions:</strong>
        <ul>
          <li>Click "Open Sample PDF" to open a sample PDF in a popup window</li>
          <li>Click "Open About Blank" to open a simple page with Hello World</li>
          <li>Click "Open Microsoft Login" to open Microsoft's login page</li>
          <li>If a popup is already open, clicking the button will focus on the existing window</li>
        </ul>
      </div>

      <div class="button-group">
        <button id="openSamplePDF" onclick="openSamplePDF()">Open Sample PDF</button>
        <button id="openAboutBlank" onclick="openAboutBlank()">Open About blank</button>
        <button id="openLogin" onclick="openMicrosoftLogin()">Open Microsoft Login</button>
      </div>

      <div id="status" class="status" style="display: none"></div>
    </div>

    <script>
      // Store references to popup windows
      const popupWindows = new Map()

      // Sample PDF URL (you can replace this with any public PDF URL)
      const samplePDFUrl = 'https://qa-tools-appsulate.onrender.com/assets/PDF_Form_File.pdf'

      function showStatus(message, isError = false) {
        const statusDiv = document.getElementById('status')
        statusDiv.textContent = message
        statusDiv.className = `status ${isError ? 'error' : 'success'}`
        statusDiv.style.display = 'block'

        // Hide status after 3 seconds
        setTimeout(() => {
          statusDiv.style.display = 'none'
        }, 3000)
      }

      function openPDFInPopup(pdfUrl, windowName = 'pdfPopup') {
        try {
          // Check if popup already exists
          if (popupWindows.has(windowName)) {
            const existingWindow = popupWindows.get(windowName)

            // Check if window is still open
            if (!existingWindow.closed) {
              // Focus the existing window
              existingWindow.focus()
              showStatus('Focused existing PDF popup window')
              return existingWindow
            } else {
              // Remove closed window from our tracking
              popupWindows.delete(windowName)
            }
          }

          // Create new popup window
          const popup = window.open(
            pdfUrl,
            windowName,
            'width=1000,height=700,scrollbars=yes,resizable=yes,menubar=yes,toolbar=yes,location=yes,status=yes',
          )

          if (popup) {
            // Store reference to the popup
            popupWindows.set(windowName, popup)

            // Focus the new window
            popup.focus()

            // Clean up reference when window is closed
            popup.addEventListener('beforeunload', () => {
              popupWindows.delete(windowName)
            })

            showStatus('PDF opened in popup window')
            return popup
          } else {
            throw new Error('Popup was blocked by browser')
          }
        } catch (error) {
          showStatus(`Error opening PDF: ${error.message}`, true)
          return null
        }
      }

      function openSamplePDF() {
        openPDFInPopup(samplePDFUrl, 'samplePDF')
      }

      function openAboutBlank() {
        try {
          // Check if popup already exists
          if (popupWindows.has('helloWorld')) {
            const existingWindow = popupWindows.get('helloWorld')

            // Check if window is still open
            if (!existingWindow.closed) {
              // Focus the existing window
              existingWindow.focus()
              showStatus('Focused existing Hello World popup window')
              return existingWindow
            } else {
              // Remove closed window from our tracking
              popupWindows.delete('helloWorld')
            }
          }

          // Create new popup window
          const popup = window.open(
            'about:blank',
            'helloWorld',
            'width=600,height=400,scrollbars=yes,resizable=yes,menubar=yes,toolbar=yes,location=yes,status=yes',
          )

          if (popup) {
            // Store reference to the popup
            popupWindows.set('helloWorld', popup)

            // Write content to the popup
            popup.document.write(`
               <!DOCTYPE html>
               <html>
               <head>
                 <title>Hello World</title>
                 <style>
                   body {
                     font-family: Arial, sans-serif;
                     display: flex;
                     justify-content: center;
                     align-items: center;
                     height: 100vh;
                     margin: 0;
                     background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                     color: white;
                   }
                   h1 {
                     font-size: 3em;
                     text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
                     animation: fadeIn 2s ease-in;
                   }
                   @keyframes fadeIn {
                     from { opacity: 0; transform: translateY(20px); }
                     to { opacity: 1; transform: translateY(0); }
                   }
                 </style>
               </head>
               <body>
                 <h1>Hello World!</h1>
               </body>
               </html>
             `)
            popup.document.close()

            // Focus the new window
            popup.focus()

            // Clean up reference when window is closed
            popup.addEventListener('beforeunload', () => {
              popupWindows.delete('helloWorld')
            })

            showStatus('Hello World opened in popup window')
            return popup
          } else {
            throw new Error('Popup was blocked by browser')
          }
        } catch (error) {
          showStatus(`Error opening Hello World: ${error.message}`, true)
          return null
        }
      }

      function openMicrosoftLogin() {
        const microsoftLoginUrl = 'https://login.microsoftonline.com'
        openPDFInPopup(microsoftLoginUrl, 'microsoftLogin')
      }
    </script>
  </body>
</html>
